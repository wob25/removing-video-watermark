### **视频坐标拾取工具 - 使用说明书**

#### **一、 工具简介**

本工具是一个专为从视频中精确选择特定区域而设计的图形化应用。它允许您：
*   加载本地视频文件。
*   通过直观的滑块实时调整选区的位置和大小。
*   在视频画面上实时预览您选择的区域（绿色矩形框）。
*   以清晰的表格形式查看最终的 `ymin, ymax, xmin, xmax` 坐标。
*   一键将格式化好的坐标元组复制到剪贴板，方便在其他程序中使用。

本工具使用了现代化的图形库，界面美观，且兼容最新的 Python 版本。

---

#### **二、 首次安装与环境准备**

在首次使用本工具前，您需要对您的电脑进行一次简单的环境配置。这个过程只需要做一次。

**步骤一：安装 Python**
*   本工具需要 **Python 3.8** 或更高版本。
*   如果您电脑上没有 Python，请访问 [Python 官方网站](https://www.python.org/downloads/) 下载并安装。
*   **重要**：在安装过程中，请务必勾选 **“Add Python to PATH”** 或 **“将 Python 添加到环境变量”** 的选项。

**步骤二：创建项目文件夹并保存代码**
1.  在您喜欢的位置（如桌面、文档）创建一个新的文件夹，可以命名为 `VideoCoordTool`。
2.  将我提供给您的最新版 Python 代码（`get_coords_gui_final.py`）保存到这个文件夹中。

**步骤三：安装所有必需的库**
1.  **打开命令行工具 (PowerShell 或 CMD)**：
    *   最简单的方法是：进入您刚刚创建的 `VideoCoordTool` 文件夹，在顶部的地址栏输入 `cmd` 或 `powershell`，然后按回车。这会直接在该目录下打开命令行。
2.  **执行安装命令**：
    在打开的命令行窗口中，**依次复制并执行**以下四条命令。每输完一条就按回车，等待它完成。
    ```bash
    pip install customtkinter
    ```
    ```bash
    pip install opencv-python
    ```
    ```bash
    pip install pyperclip
    ```
    ```bash
    pip install Pillow
    ```
    *（提示：如果您之前已经安装过其中某个库，系统会自动检测并跳过，不会重复安装。）*

**至此，您的电脑环境已全部准备就绪！**

---

#### **三、 如何使用本工具**

**步骤一：启动程序**
*   在您的命令行工具中（确保路径在 `VideoCoordTool` 文件夹下），输入以下命令并按回车：
    ```bash
    python get_coords_gui.py
    ```
*   稍等片刻，程序的主窗口就会出现。

**步骤二：打开视频**
*   点击界面右上角的 **“打开视频文件”** 按钮。
*   在弹出的文件选择框中，找到并选择您想要处理的视频文件。

**步骤三：调整选区**
*   视频加载后，您就可以使用右侧控制面板的滑块来定义选区了：
    *   **视频进度**：拖动此滑块可以跳转到视频的不同帧，方便您在特定画面上定义区域。
    *   **Y (上边界)**：控制绿色选框的**顶边**位置。数值越大，选框越靠下。
    *   **H (高度)**：控制绿色选框的**自身高度**。
    *   **X (左边界)**：控制绿色选框的**左边**位置。数值越大，选框越靠右。
    *   **W (宽度)**：控制绿色选框的**自身宽度**。

**步骤四：查看与理解坐标**
*   在您拖动滑块时，左侧视频预览窗口中的**绿色矩形框**会实时变化。
*   同时，右侧控制面板下方的 **“最终坐标”** 表格会实时更新数值：
    *   `ymin`: 选框的上边界坐标，由 **Y** 滑块直接决定。
    *   `ymax`: 选框的下边界坐标，由 `Y + H` 计算得出。
    *   `xmin`: 选框的左边界坐标，由 **X** 滑块直接决定。
    *   `xmax`: 选框的右边界坐标，由 `X + W` 计算得出。

**步骤五：复制结果**
*   当您对选区满意后，点击右下角的 **“复制元组 (ymin, ymax, xmin, xmax)”** 按钮。
*   程序会自动将格式为 `(ymin, ymax, xmin, xmax)` 的坐标字符串（例如 `(54, 150, 282, 800)`）复制到您的系统剪贴板。
*   同时会弹出一个“成功”提示框。现在您可以将这个坐标粘贴到任何您需要的地方了。

---

#### **四、 注意事项与常见问题**

*   **视频格式兼容性**：本工具支持主流的视频格式，如 `.mp4`, `.avi`, `.wmv`, `.flv` 等。如果遇到无法加载的视频，可能是文件已损坏或格式过于特殊。
*   **性能提示**：处理非常高分辨率（如 4K）或高帧率的视频时，拖动滑块可能会有轻微的延迟，这是正常现象。
*   **界面外观**：如果您不喜欢默认的界面颜色或明暗模式，可以修改代码的最后几行，将 `ctk.set_appearance_mode("System")` 中的 `"System"` 改为 `"Dark"`（暗黑模式）或 `"Light"`（明亮模式）。
*   **依赖库**：请勿随意卸载或更改已安装的四个必需库的版本，否则可能导致程序无法运行。
